local Library = {}

local TweenService = game:GetService("TweenService")
local Camera = workspace:FindFirstChildWhichIsA("Camera")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local VirtualInputManager = game:GetService("VirtualInputManager")

Library.TweenPart = function(PartToTween, TweenTime, CFrameToTweenTo, ...)
    local Hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    local Tween = TweenService:Create(PartToTween or Hrp, TweenInfo.new(TweenTime, ...), {CFrame = CFrameToTweenTo})
    return Tween
end

Library.MouseClick = function(PositionX, PositionY, HoldTime)
    VirtualInputManager:SendMouseButtonEvent(PositionX, PositionY, 0, true, game, 0)
    if HoldTime then
        task.wait(HoldTime)
    end
    VirtualInputManager:SendMouseButtonEvent(PositionX, PositionY, 0, false, game, 0)
end

Library.MoveMouse = function(PositionX, PositionY)
    VirtualInputManager:SendMouseMoveEvent(PositionX, PositionY, game)
end

Library.PressKey = function(KeyCode, HoldTime)
    VirtualInputManager:SendKeyEvent(true, KeyCode, false, game)
    if HoldTime then
        task.wait(HoldTime)
    end
    VirtualInputManager:SendKeyEvent(false, KeyCode, false, game)
end

Library.PressButton = function(ButtonLabel)
    Library.MouseClick(ButtonLabel.AbsolutePosition.X + ButtonLabel.AbsoluteSize.X/2, ButtonLabel.AbsolutePosition.Y + ButtonLabel.AbsoluteSize.Y/2)
end

Library.CenterMouseClick = function()
    Library.MouseClick(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
end

Library.MouseM = function(PositionX, PositionY)
    local centerX = Camera.ViewportSize.X / 2
    local centerY = Camera.ViewportSize.Y / 2
    local deltaX = PositionX - centerX
    local deltaY = PositionY - centerY

    local connection
    connection = UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            VirtualInputManager:SendMouseMoveEvent(centerX + deltaX, centerY + deltaY, game)
        end
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.MouseButton1 then
            connection:Disconnect()
        end
    end)
end

Library.VirtualCenterMouseClick = function()
    Library.MouseM(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    task.wait(0.1)
    VirtualInputManager:SendMouseButtonEvent(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2, 0, true, game, 0)
    task.wait(0.1)
    VirtualInputManager:SendMouseButtonEvent(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2, 0, false, game, 0)
end


return Library
